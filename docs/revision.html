<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD>
<meta name="GENERATOR" content="Microsoft&reg; HTML Help Workshop 4.1">
<meta http-equiv='Content-Type' content='text/html;charset=utf-8'>
<meta http-equiv='Content-Style-Type' content='text/css'>
<link rel="stylesheet" type="text/css" href="help.css">
<Title>改訂履歴</Title>
</HEAD>
<BODY>

<!-- header start -->
<div id='header'>
<h1>NSDL（NES Sound Driver Library）</h1>
<a href="index.html">トップ</a>＼
</div>

<!-- contents start -->
<div id='contents'>
<h2>改訂履歴（Revision）</h2>

<div class='block'>
<h3>改訂履歴</h3>
<p>
</p>
<table>
<tr><th>ヴァージョン</th><th>内容</th><th>改定日</th></tr>
<tr><td>1.31</td>
	<td>●音源ドライバ本体<br>
		・NSF Version 2における⊿PCM-IRQの割り込みベクタの設定方法が間違えていたのを修正した。<br>
		●ＭＭＬコンパイラ<br>
		・64bit版Windows用のnsc64.exeは、使用する拡張命令セットをAVX2からSSE2に変更した(Windows 10の動作条件に合わせた)。<br>
		・Visual C++.2019用のプロジェクトファイルにおいて、プリコンパイル済みヘッダー(stdafx.cpp)に関するオプションにミスがあり、.exeファイルへのコンパイル速度が遅かった点を修正した。<br>
		・OpenMPによる並列（マルチスレッド）化に対応した。<br>
		・MMLの構文解析アルゴリズムの改善により、コンパイル速度の向上を図った。<br>
		・構文エラーがあった場合、エラーが発生したMMLコマンドもエラーメッセージに出力するようにした。<br>
		・MML構文にエラーがあっても、致命的なエラーでない限りは構文解析を継続するようにした（■■■To Do:対応中）。<br>
		・jコマンドにおいて数値の省略に対応した。省略時は早送り解除とした。<br>
		・j1（早送り開始）を記述せずに、j、若しくはj0コマンド（早送り解除）が曲の途中に書かれた場合、TR1の冒頭にj1（早送り開始）を自動で挿入するようにした。<br>
		●その他<br>
		・<var>\sample\</var>フォルダのＭＭＬに、ＮＳＦ２用のコマンドを入れ込んだ(テンプレート、及び拙作のMMLのみ)。<br>
	</td>
	<td width=120>20XX年 X月XX日</td></tr>
<tr><td>1.30</td>
	<td>●音源ドライバ本体<br>
		・エミュレータmesenで再生できない現象を修正した。<br>
		●ＭＭＬコンパイラ<br>
		・オプションスイッチ<code>-x</code>により、Extended NSF (NSFe)へのコンパイルに対応した。<br>
		・オプションスイッチ<code>-v</code>により、NSFのヴァージョン指定に対応した。<br>
		　従来のNSF Version 1以外にNSF Version 2へのコンパイルに対応し、デフォルトのコンパイルをNSF version 2に変更した。<br>
		・各種メタデータに対応し、メタデータ用のコマンドを実装した（以下）。<br>
		<ul>
		<li><code>#maker</code>：制作者の名前を記述できます。</li>
		<li><code>#text</code>：テキストを記述できます。</li>
		<li><code>#Mix</code>：NSFプレイヤーに、各拡張音源の音量バランスを指定できます</li>
		<li><code>#plst</code>：NSFプレイヤーでの、再生順番を指定できます</li>
		<li><code>#psfx</code>：NSFプレイヤーでの、効果音の再生順番を指定できます</li>
		<li><code>#VRC7</code>：NSFプレイヤーに、VRC7が別の音源(OPLL)に換装されている事を設定します。</li>
		<li><code>#label</code> ：曲毎の曲名を指定します(MMLシーケンス記述ブロックにて)。</li>
		<li><code>#author</code> ：曲毎の作曲者を指定します(MMLシーケンス記述ブロックにて)。</li>
		<li><code>#time</code> ：各曲の再生時間を設定します(MMLシーケンス記述ブロックにて)。</li>
		<li><code>#fade</code> ：各曲のフェードアウト時間を設定します(MMLシーケンス記述ブロックにて)。</li>
		</ul>
		・<code>#title</code>, <code>#composer</code>, <code>#copyright</code>, <code>#maker</code>, <code>#text</code>, <code>#label</code>, <code>#author</code>コマンドは、以下のエスケープシーケンスに対応した。<br>
		<ul>
		<li><code>\a</code> ：	ベル文字（アラート）</li>
		<li><code>\b</code> ：	１文字分戻る</li>
		<li><code>\f</code> ：	ページ送り（クリア）</li>
		<li><code>\n</code> ：	改行、復帰</li>
		<li><code>\r</code> ：	同じ行の先頭に戻る</li>
		<li><code>\t</code> ：	水平タブ</li>
		<li><code>\v</code> ：	垂直タブ</li>
		<li><code>\\</code> ：	\を表示</li>
		<li><code>\?</code> ：	?を表示</li>
		<li><code>\'</code> ：	シングルクォーテーション(')を表示</li>
		<li><code>\"</code> ：	ダブルクォーテーション(")を表示</li>
		<li><code>\N</code> ：	8進定数（Nは8進数の定数）</li>
		<li><code>\xN</code> ：	16進定数(Nは16進数の定数）</li>
		</ul>
	</td>
	<td width=120>2020年12月29日</td></tr>
<tr><td>1.29</td>
	<td>●音源ドライバ本体<br>
		・PALシステム用のヴァージョン<var>nsd_pal.lib</var>を追加しました。<br>
		●ＭＭＬコンパイラ<br>
		・マクロ定義において、マクロ定義終了の"}"をコメントアウトできなかったバグを修正。<br>
		・Version 1.23より、相対ディチューン機能を実装していたものの、取説に相対ディチューンコマンドの説明が無かった点を修正。<br>
		・使用されていないサブルーチンがある場合、最適化の過程で異常終了することがあるバグを修正。<br>
		　（Visual C++ 2019でビルドしたMMLコンパイラを使うと、発生しました。）<br>
		・最適化の仕組みを改善し、より高度な最適化をするようにした。<br>
		　関連して、シーケンス（ＢＧＭ、効果音、サブルーチン）データの最適化の有無をオプションにて設定できるようにした。<br>
		・Windows 64bit用のMMLコンパイラ`nsc64.exe`を新設した。<br>
	</td>
	<td width=120>2020年 6月16日</td></tr>
<tr><td>1.28</td>
	<td>●音源ドライバ本体<br>
		・開発環境「CC65」のV2.17に対応しました。<br>
		・効果音終了からＢＧＭに復帰する際に、１フレームの無音期間が出来てしまっていた現象を改善しました。<br>
		●ＭＭＬコンパイラ<br>
		・リピートコマンド展開時における最適化処理にて、省いてはいけないコマンドを重複コマンドと誤認識して省いてしまうバグをFix しました。<br>
		●その他<br>
		・<var>\sample\ca65\</var>フォルダのアセンブリ原語での組み込みサンプルにて、演奏がもたっていたバグを修正した。<br>
	</td>
	<td width=120>2018年12月12日</td></tr>
<tr><td>1.27</td>
	<td>●音源ドライバ本体<br>
		・休符のモードが1且つ、ゲートクオンタイズのモードが1以外の時に、休符時にR@の音色に切り替わらないバグをFix した。<br>
		・効果音で、内臓音源５トラック使用可能なヴァージョン<var>nsd_se.lib</var>を追加しました。<br>
		・オクターブのデフォルトが５になっていたのを、４に修正しました（取説上はデフォルト「４」と記載、また、MMLコンパイラ側も「４」に設定されていた）。<br>
		●ＭＭＬコンパイラ<br>
		・エンベロープ定義にて、L コマンドを省略した場合に、ループ位置のエラーを検出できなかったバグをFix した。<br>
		・１行コメント（<code>//</code>, <code>;</code>）を改行しないでファイルの終端にした場合、暴走するバグをFixした。<br>
		・エンベロープ定義にて、同じ数字が続く場合、自動でランレングス圧縮するようにした。<br>
		・パッチ定義において、マクロ呼び出し及び、ローカルマクロに対応した。<br>
		・文字列の始点、終点を示す識別子として、全角の”に対応した。<br>
		・未使用のサブルーチン、エンベロープ、音色定義の最適化の有無をオプションにて設定できるようにした。<br>
		●その他<br>
		・サンプルを若干追加した。<br>
		・"<var>\sample\template\</var>"フォルダーの"<var>template.mml</var>"に、パッチ定義のひな形（ノイズチャンネルの簡易的なドラムセット）を追加しました。<br>
	</td>
	<td>2017年 1月 9日</td></tr>
<tr><td>1.26</td>
	<td>●音源ドライバ本体<br>
		・cc65 V2.15 - Git d0e0b98でビルドできるようにし、ライブラリを本ヴァージョンの仕様のフォーマットに更新した。<br>
		・効果音の優先度と早送り機能のフラグが、同じビットを使っていたコーディング・ミスを修正しました。<br>
		　<strong>これに伴い、ヘッダーファイル nsddef.inc の改定がございますので、ご留意ください。</strong><br>
	</td>
	<td>2015年 7月12日</td></tr>
<tr><td>1.25</td>
	<td>●音源ドライバ本体<br>
		・電源投入時にユーザーアプリケーション側で非Zeropageを0初期化しておかないと、三角波の再生がおかしくなることがあるバグをFix した。<br>
		　（Version 1.24から導入した、三角波のリニアカウンタ・エンベロープの初期化を忘れていた。）<br>
		　（※付属の.lib（ライブラリ）をゲームなどのアプリケーション組み込みの際に、本バグが発生しておりました。）<br>
		　（※付属の.bin（NSF用のコンパイル済み音源ドライバ）は、リセット・電源投入時に非Zeropageを0クリアするため問題ありません。）<br>
		・三角波のリニアカウンタ・エンベロープに関するコードサイズとＣＰＵ負荷を若干最適化した。<br>
		●ＭＭＬコンパイラ<br>
		・様々な音階（ハンガリー、ジプシー、およびそれらから派生したモード）に対応。<br>
	</td>
	<td>2015年 5月16日</td></tr>
<tr><td>1.24</td>
	<td>●音源ドライバ本体<br>
		・効果音を鳴らしている時に次の効果音を鳴らした場合、新たに鳴らした効果音で未使用のトラックは前の効果音が残るようにした。<br>
		・効果音を鳴らしている時にＢＧＭを再生開始した場合、効果音のスイープがリセットされるバグを修正した。<br>
		・三角波チャンネルのリニアカウンターエンベロープに対応（音量エンベロープで操作します）。<br>
		●ＭＭＬコンパイラ<br>
		・⊿PCMの発音オフセット、発音サイズを調整できるようにした。<br>
		・パッチ機能において、サブルーチンの最適化を無効にし、必ず埋め込むモードを作った。<br>
		・未使用のトラックはコンパイルしないようにした（従来は、End Of Trackのオペコードを1[Byte]出力していた）。<br>
		<b>≪ＭＭＬコンパイラを、WINDOWS以外の機種など自分でビルドしてご利用なさる方むけの対応≫</b><br>
		・ファイル名の大文字、小文字を区別する環境化でもコンパイルが通るようにファイル名を修正した。<br>
	</td>
	<td>2015年 5月12日</td></tr>
<tr><td>1.23</td>
	<td>●音源ドライバ本体<br>
		・下降方向のポルタメントにて、音長とポルタメントに要するフレーム長が同一の場合、次の音符にもポルタメントの変位が効いてしまうバグをFix。<br>
		　（※但し仕様として、音長よりもポルタメントが長い場合は、ポルタメントの変異は次の音符にも効きます。）<br>
		　（※ポルタメント処理が終了した場合にのみ、次の音符にてポルタメントの変異がリセットされます。）<br>
		・ゲート長より発音長が短い音符があり、その次が休符の場合において、KeyOffされないバグをFix。<br>
		・⊿PCMのIRQに対応した.binで複数曲内包したNSFをTNS-HFCxで再生した場合、２曲目以降が再生できないバグをFix。<br>
		・FDS音源にて、SweepBiasの初期化が行われておらず、音程が外れることがあるバグをFix。<br>
		・N16x音源にて、サンプル長が不定だったのを、32[sample]（s56）で初期化するようにした。<br>
		・VRC7音源に対して、音量、音色、周波数のレジスタアクセスを最短(データシートのギリギリ)で行うように最適化した。<br>
		・VRC7音源にて、 @ コマンドと、E@コマンド（レジスタに対するエンベロープ）を同じTickに置いた場合、 @ コマンドによる音色変更ができなかったバグをFix。<br>
		・VRC7音源にて、ハードウェアをKeyOffしないまま、ソフトウェアエンベロープだけKeyOffする機能を実装した（sコマンドで行います）。<br>
		・三角波のリニアカウンタ（$4008）の制御に対応（sコマンドで行います）。<br>
		・音程について、n16x以外は12.5[cent]単位の制御だったが、n16xと同じく6.25[cent]単位に変更。音程の精度を倍にしました。<br>
		　（※但し、n16x以外の音程テーブルそのものは12.5[cent]毎のテーブルであり、線形補完により算出します。）<br>
		・休符のモードを１つ追加し、`Rm'コマンドのモードに従うモードを新設した。<br>
		●ＭＭＬコンパイラ<br>
		・パッチ記述ブロックにて、_コマンド、sコマンドがコンパイルエラーになる事があるバグをFix。<br>
		・()にて囲む数値および、""にて囲む文字列について、閉じ忘れなどの文法ミスを検出するようにした。<br>
		　（今まで検出しておらず、こういった文法ミスによるエラーが発生した際、コンパイルエラーの真因を特定し難かった。）<br>
		・検索パスの仕組みを導入した。<br>
		・それに伴い、binファイル、dmcファイル、インクルードファイルの検索パスを登録するオプションスイッチを導入しました。<br>
		・#QReverseコマンドを新設。qコマンドとQコマンドを入れ替えます。<br>
		・休符コマンド(r,w)のパラメータに`*'（`Rm'コマンドのモードに従う）を新設した。<br>
		・#rest コマンド、 #wait コマンドにて、モード３（`Rm'コマンドのモードに従う）を新設した。。<br>
		・疑似エコーのバッファを制御するコマンドを追加した。<br>
		<b>≪ＭＭＬコンパイラを、WINDOWS以外の機種など自分でビルドしてご利用なさる方むけの対応≫</b><br>
		・動作時に出力するメッセージの文字コードについて、"_WIN32"を定義してビルドした場合（付属のnsc.exeを含む）はShift-JIS、
		_WIN32を定義しないでビルドした場合はEUCとしていたが、動作環境に応じた文字コードで出力するようにした。<br>
		・また、UNICODE（wchar_t, wcout, wcerr）に対応していないC/C++コンパイラへの配慮として、UNICODE文字列とマルチバイト文字列を選択する #define 文を追加。
		"_UNICODE"を定義した場合UNICODE、定義しない場合はマルチバイト文字列としてコンパイルします。<br>
		●取扱説明書<br>
		・各コマンドについて、デフォルトの値、疑似コマンドか否かを分かり易くした。<br>
		・最適化のためのヒントを更新した。<br>
	</td>
	<td>2014年12月31日</td></tr>
<tr><td>1.22</td>
	<td>●ＭＭＬコンパイラ<br>
		・#TieModeコマンドを追加。^記述時の挙動を設定できます。<br>
		・符号なしなのに、unsignedを付け忘れていて、一部のＣ++コンパイラでコンパイルできなかったバグをFix。<br>
		・ECコマンドにて第２パラメータが-1、第３パラメータの指定が無い、且つ、リピート終了の前と後の両方が休符の場合、リピート終了直前の疑似エコーにスラー／タイのフラグが立ってしまうバグをFix。<br>
		・疑似エコー使用時に、若干最適化してコンパイルするようにした。<br>
		●取扱説明書<br>
		・疑似エコーと、パッチ機能に関する説明文・記述を見直した。<br>
		・ＭＭＬ全体の構文に関する説明文・記述を若干、見直した。<br>
	</td>
	<td>2014年 8月20日</td></tr>
<tr><td>1.21</td>
	<td>●音源ドライバー本体<br>
		・Version 1.20において、"nsd.bin"がTNS-HFC3, TNS-HFC4で動作しなくなっていたバグをFix。<br>
		●ＭＭＬコンパイラ<br>
		・Patch()コマンドを、P()と省略できるようにした。<br>
		・Patch()記述ブロック内にて、qコマンド、uコマンドを定義できるようにした。<br>
		・Patch()記述ブロック内にて、#OffsetE*が効いていなかったバグをFix。<br>
		・マクロが１つも定義されてない状態でマクロ呼び出しを行うと、例外が発生するバグをFix。<br>
		　（本来は、マクロが定義されてない旨のエラーメッセージを表示）<br>
		・Windows以外のＯＳ（UNIX系、マッキントシュ、等）で、\コマンドが使えなかったバグをFixしたつもり。<br><strong>（※実機を所有していないため未確認です。報告求ム）</strong><br>
	</td>
	<td>2014年 8月15日</td></tr>
<tr><td>1.20</td>
	<td>●音源ドライバー本体<br>
		・ドライバレベルで早送りをするコマンドを追加。<br>
		●ＭＭＬコンパイラ<br>
		・シーケンス記述ブロックにローカルマクロを実装。<br>
		　従来のマクロは、グローバルマクロとなります。<br>
	</td>	<td>2014年 7月25日</td></tr>
<tr><td>1.19</td>
	<td>●ＭＭＬコンパイラ<br>
		・パッチ機能を実装した。<br>
		　それに伴い、Patch(){}コマンド（パッチ記述ブロック）、@P、@P*コマンドを実装した。<br>
		・要素数単位で指定可能なn16x音色波形転送（ロード）コマンド（@NLコマンド）を実装した。<br>
		・要素数単位で指定可能なn16x音色波形＆サンプル長指定コマンド（@NSコマンド）を実装した。<br>
		・未使用のサブルーチンがある場合に、最適化の過程で例外が発生することがあるバグをFixした。<br>
		●取扱説明書<br>
		・n16xに関する説明文・記述を見直した。<br>
	</td>
	<td>2014年 7月 4日</td></tr>
<tr><td>1.18</td>
	<td>●ＭＭＬコンパイラ<br>
		・未使用のエンベロープ、音色、サブルーチンはコンパイルしないようにし、出力サイズを軽減するようにした。<br>
		　（使う分だけをコンパイルするため、汎用的な定義を沢山作ることが可能になります。）<br>
		・Visual C++.net 2008 でビルドしたコンパイラにてリピート機能を使うと、例外が発生するバグをFixした。<br>
		　（※Visual C++.net 2003及び、gccでビルドしたＭＭＬコンパイラは、問題無いようです。）<br>
		　（※アーカイブに同封のＭＭＬコンパイラ(nsc.exe)は、Visual C+.net 2003にてビルドしています。）<br>
	</td>
	<td>2014年 5月20日</td></tr>
<tr><td>1.17</td>
	<td>●ＭＭＬコンパイラ<br>
		・ＭＭＬコンパイラ展開のリピートを実装した。<br>
		・#RepeatModeコマンド（リピートコマンドの展開方法の設定）を実装した。<br>
		・#ReleaseVolumeコマンド（デフォルトのリリース音量の設定）を実装した。<br>
	</td>
	<td>2014年 5月12日</td></tr>
<tr><td>1.16</td>
	<td>●音源ドライバー本体<br>
		・利便性を考え、makefileや、ヘッダーファイルを作り直した。<br>
		・nsd_main_bgm()関数及び、nsd_main_se()関数を実装した。<br>
		　これにより、マッパーＬＳＩ使用時に、ＢＧＭと効果音を異なるバンクに配置することが出来ます。<br>
		・演奏状態を保存するnsd_save()関数及び、演奏状態をロードするnsd_load()関数を実装した。<br>
		　これにより、別の曲を鳴らしている最中でも、演奏状態を保存した曲を途中から再生可能です。<br>
		・制御用構造体を最適化し、使用するＲＡＭの量を減らした。<br>
		　拡張音源無しの`nsd.lib'では、セグメント"bss"（未初期化データ）領域が14[Byte]減ります。<br>
		●サンプル<br>
		・makefileや、ヘッダーファイルの作り直しに伴う改定。<br>
		●ＭＭＬコンパイラ<br>
		・Tick数をカウントする処理を追加した。また、-t オプションにて無効にできます。<br>
		</td>
	<td>2014年 4月27日</td></tr>
<tr><td>1.15</td>
	<td>●音源ドライバー本体<br>
		・ポルタメント後にスラーで繋げた場合、繋げた先の音符でポルタメントの変位がそのままになってしまうバグをFixした。<br>
		●ＭＭＬコンパイラ<br>
		・エラー・ワーニングの出力先を標準エラー出力に設定するオプションスイッチを実装した。<br>
		・それに伴い、エラー、ワーニングの出力先のデフォルトは、標準出力とした。<br>
		・Jコマンドにて、ポルタメントも無視するようにした。<br>
		・相対音量コマンドにて、数値指定し変化量を指定できるようにした。<br>
		・{}コマンドにて、ポルタメントを簡素化して記述できるようにした。<br>
		・マクロ定義の中で、`{'の個数分だけ`}'を記述できるようにした。<br>
		　これに伴い、マクロの中で、K{}コマンド、{}コマンドが使えるようになります。<br>
		・ド♭、シ＃がある場合、疑似エコーコマンドにて疑似エコーを正常に生成できていなかったバグを修正。<br>
		・kコマンドによる、ＭＭＬコンパイラ側での移調に対応した。<br>
		・音長に０を指定するとハングするバグが再発していたので、修正した。<br>
		●取扱説明書<br>
		・エンベロープの説明にて、ＦＤＳ音源のキャリアとモジュレータの説明が逆になっていたのを修正。<br>
		</td>
	<td>2014年 3月 4日</td></tr>
<tr><td>1.14</td>
	<td>●ＭＭＬコンパイラ<br>
		・エラー、ワーニングは、標準出力ではなく、エラー出力に出力するようにした。<br>
		　これにより、アプリケーション組み込み時のmakefile等が作りやすくなります。<br>
		・音符、休符、サブルーチン、効果音呼出を無視するコマンドに対応。<br>
		　このコマンドにより、コメントアウトしないでも、シーケンスの途中から鳴らすことができます。<br>
		・ゲートクオンタイズに対応。また、分母も曲毎に設定可能です。<br>
		</td>
	<td>2014年 2月25日</td></tr>
<tr><td>1.13</td>
	<td>●音源ドライバー本体<br>
		・nsd_all.bin, nsd_all2.bin, nsd_oall.bin, nsd_hfe4.bin, nsd_hfx4.binにて、
		Version 1.12におけるシーケンス64kByte化の副作用として、音量エンベロープが効かなくなることがあるバグ及び、
		ΔＰＣＭのＩＲＱが使えなくなっていたバグをFix。<br>
		・ノートコマンドのオペコードのビット位置を最適化のためを変更しました。<br>
		・オクターブコマンドで指定できるオクターブを２～９から１～８へ変更しました。<br>
		●ＭＭＬコンパイラ<br>
		・疑似エコーのバッファをリセットするコマンドを実装した。<br>
		・EC（疑似エコー）コマンドにオプションで第三パラメータを追加し、
		休符を書かないでも疑似エコーをできるようにした。<br>
		・音符及び休符にて、lコマンドと音長が同じ場合は、1Byte短いオペコードを出力するようにした。<br>
		・音量、ゲートタイムの指定値が前回と同じ場合は、コンパイルしないようにした（リピート、ダルセーニョ後は除外）。<br>
		</td>
	<td>2014年 1月19日</td></tr>
<tr><td>1.12</td>
	<td>●音源ドライバー本体<br>
		・Sunsoft 5Bにて、sコマンド使用時にプチノイズが入る場合があるバグを修正。<br>
		・効果音の優先度設定に対応。<br>
		・効果音にて、パルス波ch2, ノイズchで個別の効果音を鳴らせるようにした。<br>
		・nsd_all.bin, nsd_all2.bin, nsd_oall.bin, nsd_hfe4.bin, nsd_hfx4.binにて、シーケンスを64KByteまで使えるようにした。<br>
		●ＭＭＬコンパイラ<br>
		・マクロ名の検出アルゴリズムを変更し、長いマクロ名を優先するようにしました。<br>
		●取扱説明書<br>
		・Tipsのスケールとコードに、各コード（和音）毎に使えるスケール（旋法）を記載しました。<br>
		</td>
	<td>2014年 1月 3日</td></tr>
<tr><td>1.11</td>
	<td>●音源ドライバー本体<br>
		・フレームオーバーによる暴走回避ルーチンを実装。<br>
		・移調の演算を、エンベロープの処理ルーチンから、ノート番号の計算ルーチンへ移動。<br>
		・nsd_hfx4.bin を新設。OPLLを含む全ての拡張音源を使用可能です。<br>
		●ＭＭＬコンパイラ<br>
		・w コマンド（休符２）を実装しました。<br>
		・休符のモードを設定する、#rest コマンド、 #wait コマンドを実装しました。<br>
		・音長の減算を`~'でもできるようにしました。<br>
		・マクロ名の検出アルゴリズムを変更し、スペースを置く必要を無くしました。<br>
		・Mode(), Major, Minor, MMinor(), HMinor()コマンドを新設しました。<br>
		●コンパイル済み音源ドライバ<br>
		・TNS-HFCシリーズにおいて、nsd_all.bin, nsd_all2.bin使用時にリセットボタンを連打するとハングする不具合を修正。<br>
		・TNS-HFC4にVRC6, VRC7を差した時に、ハングする不具合を修正。<br>
		　但し、nsd_all.bin, nsd_all2.binをリンクした場合は、TNS-HFC4に直接VRC6, VRC7を刺すとハングします。<br>
		　これらのドカモリ用のbinにおいて、TNS-HFC4でVRC6, VRC7を使う場合は、TNS-HFX4が必須となります。<br></td>
	<td>2013年 9月16日</td></tr>
<tr><td>1.10</td>
	<td>●音源ドライバー本体<br>
		・VRC7, OPLLにて、音色切り替わり時に最初の音が正常に発音されない場合があったバグを修正。<br>
		●コンパイル済み音源ドライバ<br>
		・ΔPCM-IRQの割り込み処理中にNMI割り込みが発生した場合に、ΔPCMが正常に発音されなくなるバグを修正。<br></td>
	<td>2013年 6月 9日</td></tr>
<tr><td>1.09</td>
	<td>●音源ドライバー本体<br>
		・VRC7, OPLLの@コマンド及び音色エンベロープにて、ユーザー音色のTL, MLを操作出来るようにした。<br>
		　（ドライバー内部での論理演算により他のパラメータに影響を与えずに設定します。）</td>
	<td>2013年 5月29日</td></tr>
<tr><td>1.08</td>
	<td>●音源ドライバー本体<br>
		・⊿PCMが停止できなくなっていたバグを修正。<br>
		●ＭＭＬコンパイラ<br>
		・cis-moll, gis-moll, dis-mollの不具合を修正。<br></td>
	<td>2013年 5月13日</td></tr>
<tr><td>1.07</td>
	<td>●音源ドライバー本体<br>
		・ノイズチャンネルで音色エンベロープが出来なかったバグを修正。<br>
		・再生ルーチン処理中にIRQが発生するNSFプレイヤーにおいて、
		⊿PCM-IRQを使用時に正常に再生されない可能性があるバグを修正。<br>
		（※実機では、NMIの方が優先順位が高いため、この現象は発生しません。）<br>
		●ＭＭＬコンパイラ<br>
		・NSFへビルドする場合に、音源ドライバー情報をNSFに含めるようにした。<br>
		（※この情報は、音源ドライバのライブラリ本体には含まれていません。）<br>
		・NSFへビルドする場合に、サイズ、バンク数などの情報を出力するようにした。<br>
		・K{}コマンドにおいて、短調の調号指定が一部音楽理論的に間違えていたミスを修正。<br>
		・エラー、警告のメッセージの内容を全体的に見直した。<br>
		●取扱説明書<br>
		・スケールとコードの関係表に４和音のコードを追加。<br>
		・ＦＡＱによくある質問を追加した。<br>
		・いくらかの誤植を修正。<br></td>
	<td>2013年 5月12日</td></tr>
<tr><td>1.06</td>
	<td>●音源ドライバー本体<br>
		・効果音発音終了時に、ＢＧＭの音程に戻らない場合があるバグを修正。<br>
	<td>2013年 4月13日</td></tr>
<tr><td>1.05</td>
	<td>●音源ドライバー本体<br>
		・nsd_vrc6.binが、TNS-HFC3で鳴らなくなっていた不具合を修正。<br>
		●ＭＭＬコンパイラ<br>
		・Scale()コマンドを実装した。<br>
		　K{}コマンドの調指定とあわせ、その調におけるスケール（20種）を設定できるようになりました。<br>
		●取扱説明書<br>
		・いくらかの誤植を修正。<br></td>
	<td>2013年 4月10日</td></tr>
<tr><td>1.04</td>
	<td>●ＭＭＬコンパイラ<br>
		・オプションスイッチで何も指定しない場合は、ＮＳＦに変換するようにした。<br>
		　ＭＭＬをＤ＆Ｄしてコンパイルできるようになりました。<br>
		　（※その場合は、カレントディレクトリは、ＭＭＬコンパイラのあるディレクトリです。）<br>
		・K{}コマンドで、調（例：C-Dur, c-moll, etc..）で指定できるようにした、<br>
		●ROMイメージ（nsf）の起動コード ＆ ＭＭＬコンパイラ<br>
		・TNS-HFC3で、⊿PCMのIRQを使用する方法を思いついたので、対応した。<br>
		●取扱説明書<br>
		・チュートリアル作成中（まだ、作り途中です）。<br></td>
	<td>2013年 4月 6日</td></tr>
<tr><td>1.03</td>
	<td>●ＭＭＬコンパイラ<br>
		・ストトン記法に対応。<br>
		●その他<br>
		・`sample\template'フォルダーに、「ＭＭＬ記法」及び「ストトン記法」のテンプレートを追加した。<br></td>
	<td>2013年 3月12日</td></tr>
<tr><td>1.02</td>
	<td>●ＭＭＬコンパイラ<br>
		・NSFヘッダーの拡張音源フラグを指定する#Externalコマンドを実装した。<br>
		・#Bankコマンド指定時に、NSF中でシーケンス領域を固定で24kByte確保いていたのを、サイズに合わせるようにした。<br>
		●取扱説明書<br>
		・⊿PCMの定義ブロック部において、サンプリングレートの説明が抜けていた。<br></td>
	<td>2013年 2月20日</td></tr>
<tr><td>1.01</td>
	<td>●音源ドライバー本体<br>
		・nsd_all.bin 及び nsd_all2.bin にて、⊿PCMのバンク切り替え及びIRQに対応した。<br>
		●ＭＭＬコンパイラ<br>
		・#Bankコマンド（上述の.binを使う場合に指定）を追加した。<br>
		・⊿PCMの記述ブロックにおいて、IRQに対応した。<br>
		●取扱説明書<br>
		・各.lib/.binの仕様の説明を追加した。<br></td>
	<td>2013年 2月15日</td></tr>
<tr><td>1.00</td>
	<td>●音源ドライバー本体<br>
		・一時停止関数（nsd_pause_bgm()）及び、再生再開関数（nsd_resume_bgm()）を実装した。<br>
		・nsd_stop_bgm()関数で再生停止したときに発音中の音があった場合、鳴りっぱなしになっていたバグを修正。<br>
		●ＭＭＬコンパイラ<br>
		・マクロに対応した。<br>
		・疑似エコーに、スラーで繋げるモードを追加した。<br>
		・リピート(A)コマンドにて、リピート回数をどちらにも記述できるようにした。<br>
		・アセンブリ言語ソースを出力する際に、数値が3桁毎にカンマが出てしまっていたバグを修正。<br>
		・#SegmentPCMコマンドが機能していなかったバグを修正。<br>
		・#SegmentPCMコマンドにて""を指定した際、アセンブリ言語で⊿PCMの実体を出力しないようにした。<br>
		●取扱説明書<br>
		・これまでに質問があった内容を、ＦＡＱに記載しました。<br>
		・その他、色々と見直しました。<br>
		●その他<br>
		・アセンブリ言語から nsd.lib を制御するサンプルソースを作った。<br></td>
	<td>2013年 2月 9日</td></tr>
</table>
</div>

<div class='block'>
<h3>改訂履歴（α・β版）</h3>
<p>
</p>
<table>
<tr><th>ヴァージョン</th><th>内容</th><th>改定日</th></tr>
<tr><td>0.27β</td>
	<td>●音源ドライバー本体<br>
		・使用するＲＡＭの量を若干減らした。<br>
		●ＭＭＬコンパイラ<br>
		・TRコマンドにて複数トラックの指定に対応した。<br></td>
	<td>2013年 1月18日</td></tr>
<tr><td>0.26β</td>
	<td>●音源ドライバー本体<br>
		・拡張音源使用時に、使用するＲＡＭの量を若干減らした。<br>
		●ＭＭＬコンパイラ<br>
		・#timebase コマンドを実装した。<br></td>
	<td>2013年 1月11日</td></tr>
<tr><td>0.25β</td>
	<td>●音源ドライバー本体<br>
		・FDSに対応。<br>
		・BGMから、SE（効果音）を呼べるようにした。<br>
		・効果音発音終了時に、BGMへうまく復帰できていなかったバグを修正。<br>
		●ＭＭＬコンパイラ<br>
		・FDS関連のコマンド群を実装した。<br>
		・SEを呼ぶコマンド SE を実装した。<br></td>
	<td>2013年 1月10日</td></tr>
<tr><td>0.24β</td>
	<td>●ＭＭＬコンパイラ<br>
		・#offsetE@, #offsetEv, #offsetEm, #offsetEnコマンドを追加した。<br>
		●取扱説明書<br>
		・Spcial Thanksを追加しました。<br>
		・VRC7の音色について、また、少し数学的な解説を追記した。<br></td>
	<td>2013年 1月 5日</td></tr>
<tr><td>0.23β</td>
	<td>●ＭＭＬコンパイラ<br>
		・エンベロープ定義で、(<var>start</var>,<var>end</var>,<var>length</var>)の指定をできるようにした。<br>
		●取扱説明書<br>
		・VRC7の音色パラメータについて、少し解説を追記した。<br>
		・nsd_oall.binの仕様を記載（書き忘れていた）。</td>
	<td>2012年12月22日</td></tr>
<tr><td>0.22β</td>
	<td>●ＭＭＬコンパイラ<br>
		・gccでコンパイルできるように、ソースを修正。<br>
		　（Ｃ++の機能だけを使っているつもりが、Visual C++の機能を使っていた。）<br>
		●その他<br>
		・修正ＢＳＤライセンス（但しNSFデータは除外）に変更しました。<br>
	<td>2012年12月 1日</td></tr>
<tr><td>0.21β</td>
	<td>●音源ドライバー本体<br>
		・OPLLのリズム音源の仕様を変更。音程を持たせれるようにした。<br>
		・OPLLのリズム音源がちゃんとなってなかったバグをFix。<br>
		・曲頭の休符に、通常の休符を使うと不要な音が鳴ってしまっていた仕様を改善。鳴らなくした。<br>
	<td>2012年11月19日</td></tr>
<tr><td>0.20β</td>
	<td>●音源ドライバー本体<br>
		・ノートナンバー64以降の⊿PCMの定義が適用されていなかったバグを修正。<br>
		・OPLLに対応（改造VRC7搭載カートリッジ）。<br>
		●ＭＭＬコンパイラ<br>
		・⊿PCMを使う曲をnsfにビルドする際に、少しファイルサイズが小さくなるようにした。<br>
		●取扱説明書<br>
		・疑似エコー及び、制御トラックが説明不足だった点を加筆。</td>
	<td>2012年11月13日</td></tr>
<tr><td>0.19β</td>
	<td>●音源ドライバー本体<br>
		・"nsd_all.bin"に、音源に割り当てないトラックを設けた。<br>
		　テンポコマンドや、n106/163とVRC7の音色設定等の設定トラックとして使用可能です。<br>
		・いつの間にか、効果音がならなくなっていたバグを修正。<br>
		●ＭＭＬコンパイラ<br>
		・疑似エコー（MMLコンパイラ側の命令です）を実装しました。<br>
		・範囲コメントの終端 */ の直後（スペースを空けず）に記述したコマンドが認識されなかったバグを修正。<br>
		●取扱説明書<br>
		・ちょっと見やすさを考えてみた。</td>
	<td>2012年11月12日</td></tr>
<tr><td>0.18β</td>
	<td>●音源ドライバー本体<br>
		・Sunsoft 5Bに対応。<br>
		・Rm0コマンドで、⊿PCMが指定音長でKeyOffされなかったバグをFix。<br>
		●ＭＭＬコンパイラ<br>
		・バンクが不連続に配置されたnsfに非対応の実機再生環境に対応（TNS-HFC3など）。<br>
		●取扱説明書<br>
		・Rm0コマンドで、⊿PCMが指定音長でKeyOffされる旨を記載（書き忘れていた）。</td>
	<td>2012年10月22日</td></tr>
<tr><td>0.17β</td>
	<td>●音源ドライバー本体<br>
		・n163にて、アドレス$40番地以降（@命令にて32に相当するアドレス）の波形データを破壊してしまっていたバグを修正。<br>
	<td>2012年10月19日</td></tr>
<tr><td>0.16β</td>
	<td>●音源ドライバー本体<br>
		・Version 0.10β～0.15βにて、実機で鳴らなくなっていた不具合を修正。<br>
		●取扱説明書<br>
		・n163の使い方の解説ページを追加。</td>
	<td>2012年10月15日</td></tr>
<tr><td>0.15β</td>
	<td>●音源ドライバー本体<br>
		・n163に対応。</td>
	<td>2012年10月11日</td></tr>
<tr><td>0.14β</td>
	<td>●音源ドライバー本体<br>
		・色々と拡張音源を実装するに当たり、改めてコードを再確認。無駄なコードを省いて若干最適化した。<br>
		・nsd_all.binを作った。現状、内蔵音源及びVRC6 VRC7 MMC5のみに対応です。<br>
		●取扱説明書<br>
		・取説を見直して、若干、再構成した。<br></td>
	<td>2012年10月 6日</td></tr>
<tr><td>0.13β</td>
	<td>●音源ドライバー本体<br>
		・VRC7に対応。</td>
	<td>2012年10月 3日</td></tr>
<tr><td>0.12β</td>
	<td>●音源ドライバー本体<br>
		・⊿PCMの休符の処理で、r,r+ の挙動と、 r- の挙動が逆になってたバグをFix。</td>
	<td>2012年10月 2日</td></tr>
<tr><td>0.11β</td>
	<td>●音源ドライバー本体<br>
		・VRC6に対応。<br>
		・MMC5に対応。</td>
	<td>2012年10月 1日</td></tr>
<tr><td>0.10β</td>
	<td>●音源ドライバー本体<br>
		・⊿PCMに対応。<br>
		●ＭＭＬコンパイラ<br>
		・⊿PCM対応により、DPCM{}記述ブロックが増えました。<br>
		・TR5の各音階に、⊿PCMを割り当てることができます。<br>
		●取扱説明書<br>
		・「索引」と「検索」を実装した。<br></td>
	<td>2012年 9月30日</td></tr>
<tr><td>0.07α</td>
	<td>●音源ドライバー本体<br>
		・⊿PCMルーチンを開発中（未デバッグです）。<br>
		●ＭＭＬコンパイラ<br>
		・コンパイルオプションで、NSF用の実行コード(*.bin)を指定できるようにした。<br>
		・nsfにコンパイルする場合において、実行コードを0xE000番地から0x8000番地に変更した。<br>
		　これにより、⊿PCMが実装できれば、合計16KByte（0xC000～0xFFFF番地）使えるようになります。<br>
		・"#offsetPCM"コマンドを実装。曲データはこのアドレス-1までの領域とし、これ以後を⊿PCMの領域として割り当てます。<br>
		・それに伴い、シーケンスデータが"#offsetPCM"コマンドで指定したアドレスを超えた場合に、エラーを吐くようにした。<br>
		　（シーケンスデータが32kByteを超えると、コンパイラがハングするバグがありました。）<br>
		・アセンブリ言語出力に対応した。<br>
		・また、それに伴い、出力するアセンブリ言語に対して、各種設定するコマンドを実装。<br>
		・アセンブリ言語出力に対応したので、アーカイブ中の"\sample\cc65\"のサンプルＣ言語コードも書き直しました。<br>
	<td>2012年 9月25日</td></tr>
<tr><td>0.06α</td>
	<td>●音源ドライバー本体<br>
		・ポルタメントに対応した。<br>
		●ＭＭＬコンパイラ<br>
		・エンベロープ・サブルーチンにおいて、0～4294967295番まで指定できるようにした（以前は0～65535番でした）。<br>
		・エンベロープのパターン定義において、Lコマンドを省略できるようにした。<br>
		・エンベロープのパターン定義において、音源ドライバが暴走するようなパターン定義の場合、エラーを吐くようにした。<br>
		・K{}コマンド（調号）により、r（休符）にも自動で調号（キーオフのモード指定）を付けられるようにした。<br>
		●取扱説明書<br>
		・休符や、エンベロープについて説明が足りていなかったので、追記した。<br>
		・ＦＡＱのページを作成した。</td>
	<td>2012年 9月17日</td></tr>
<tr><td>0.05α</td>
	<td>●音源ドライバー本体<br>
		・効果音処理ルーチンを開発中（一応、効果音が使えるようになってますが、未デバッグです）。<br>
		●取扱説明書<br>
		・BGM,SEデータフォーマット（Format of BGM and SE）のページにおいて、エンベロープがまだ実装されていないことになっていた記述を修正。<br>
		●ＳＤＫ<br>
		・アセンブリ言語及び、Ｃ言語用のヘッダーファイルを作成した。"include"フォルダを参照。<br>
		●ＭＭＬコンパイラ<br>
		・音名・休符コマンドに、付点のみを指定できなかったバグを修正。</td>
	<td>2012年 9月12日</td></tr>
<tr><td>0.04α</td>
	<td>●取扱説明書<br>
		・主に、ノイズチャンネル関連の説明が不足していた点を加筆。<br>
		●ＭＭＬコンパイラ<br>
		・0及び9から始まる音長を、コンパイルできなかったバグを修正（水平展開できてなかった）。<br>
		・音長で0を指定すると、例外が発生して異常終了するバグを修正。</td>
	<td>2012年 9月 7日</td></tr>
<tr><td>0.03α</td>
	<td>●音源ドライバー本体<br>
		・エンベロープを４系統実装した。<br>
		●ＭＭＬコンパイラ<br>
		・オクターブの設定値が１つ高かったバグを修正。<br>
		・0及び9から始まる数値を、コンパイルできなかったバグを修正。<br>
		・サブルーチン番号で128を超えた場合に、コンパイルできないことがあったバグを修正。<br>
		・トラック先頭に L コマンドを書いた場合、無限ループされないコードにコンパイルしていたバグを修正。</td>
	<td>2012年 9月 6日</td></tr>
<tr><td>0.02α</td>
	<td>●音源ドライバー本体<br>
		・休符時の音量の状態が設計どおりで無かったバグを修正。<br>
		・サブルーチンからの復帰時に、戻り先のアドレスがずれていたバグを修正。<br>
		・リピート(A)命令でリピートされなかったバグを修正。<br>
		・リピート(B)命令をもう１系統作った。（op-code 0x18～0x1A）<br>
		・音色命令を追加（op-code 0x1B）。この命令は、音色エンベロープと排他的に使用できる予定です。<br>
		●ＭＭＬコンパイラ<br>
		・作りました。</td>
	<td>2012年 9月 3日</td></tr>
<tr><td>0.01α</td>
	<td>α版です。<br>
		どこまで動くかは分からないが、評価版として公開。<br>
		まずは、音源ドライバーを設計。<br>
		効果音はまだ実装していませんので、効果音関係の関数は呼ばないでください。<br></td>
	<td>2012年 8月10日</td></tr>
</table>
</div>
</div>

</BODY>
</HTML>
