<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD>
<meta name="GENERATOR" content="Microsoft&reg; HTML Help Workshop 4.1">
<meta http-equiv='Content-Type' content='text/html;charset=utf-8'>
<meta http-equiv='Content-Style-Type' content='text/css'>
<link rel="stylesheet" type="text/css" href="help.css">
<Title>MML reference: Patch define block</Title>
</HEAD>
<BODY>

<!-- header start -->
<div id='header'>
<h1>NSDL（NES Sound Driver Library）</h1>
<a href="index.html">トップ</a>＼
<a href="usage.html">使い方</a>＼
<a href="usage_nsc.html">MMLコンパイラ</a>＼
<a href="mml.html">MML文法</a>＼
</div>

<!-- contents start -->
<div id='contents'>
<h2>MML reference: Patch define block</h2>

<!-- ──────────────── -->
<div class='block'>
<h3>定義（Define）</h3>
<code><pre>
Patch(<var>n</var>){
	<var>define</var>
}

P(<var>n</var>){
	<var>define</var>
}
</pre></code>
</div>

<!-- ──────────────── -->
<div class='block'>
<h3>引数（Inputs）</h3>

<h4>n</h4>
<p>
パッチ番号を指定します。
</p>

<h4>define</h4>
<p>
パッチ内容を定義します。<br>
</p>
<p>
Table 1.の音域の定義コマンドにより、定義する音域の開始音程を指定します。<br>
次に高い定義の音程の半音下までが、音域の範囲となります。<br>
デフォルト（これらのコマンドが出現するまで）は、ノートナンバー０（オクターブ１のＣ）となります。<br>
</p>

<table>
<caption>Table 1.音域の定義</caption>
<tr><th>Command</th><th>Contens</th></tr>
<tr><td>n<var>no</var>	</td><td>定義する開始音程を、指定のノートナンバーで設定します。<br>
								o1cが、ノートナンバー 0 となります。	</td></tr>
<tr><td><var>note</var><span style="color:blue;">(</span><var>Accidentals</var><span style="color:blue;">)</span><var>octave</var>	</td>
	<td>定義する開始音程を、音名及びオクターブで設定します。<br>
		<var>note</var>：音名
		<dl>
			<dt>a … </dt><dd>A, La, ラ</dd>
			<dt>b … </dt><dd>H, Si, シ</dd>
			<dt>c … </dt><dd>C, Do, ド</dd>
			<dt>d … </dt><dd>D, Re, レ</dd>
			<dt>e … </dt><dd>E, Mi, ミ</dd>
			<dt>f … </dt><dd>F, Fa, ファ</dd>
			<dt>g … </dt><dd>G, Sol, ソ</dd>
		</dl>
		<var>Accidentals</var>：臨時記号（省略可）
		<dl>
			<dt>+ … </dt><dd>&#9839; Sharp</dd>
			<dt># … </dt><dd>&#9839; Sharp</dd>
			<dt>- … </dt><dd>&#9837; Flat</dd>
		</dl>
		<var>octave</var>：オクターブ
	</td></tr>
<tr><td>$<var>name</var>	</td><td>マクロ<var>name</var>を呼び出します。	</td></tr>
<tr><td>$$<var>name</var>	</td><td>ローカルマクロ<var>name</var>を定義します。	</td></tr>
</table>

<p>
Table 2.のコマンドにより、指定した音域に適用するコマンドを指定します。<br>
ＭＭＬコンパイラは、シーケンス記述ブロックに指定された音域に応じて、これらのコマンドを自動で挿入します。<br>
パッチ定義されなかったコマンドは、挿入しません。<br>
※尚、指定数値が同じだった場合は、コマンドの自動挿入を省略します。<br>
</p>
<table>
<caption>Table 2.音域毎のコマンド定義</caption>
<tr><th>Command</th><th>Contens</th></tr>
<tr><td>_<var>n</var>	</td><td><a href="mml_transpose.html">移調</a>を指定します。	</td></tr>
<tr><td>q<var>n</var>	</td><td><a href="mml_gate.html">クオンタイズ（短くする値）</a>を指定します。	</td></tr>
<tr><td>u<var>n</var>	</td><td><a href="mml_gate.html">クオンタイズ（実際の発音長）</a>を指定します。	</td></tr>
<tr><td>s<var>n</var><span style="color:blue;">(</span>,<var>n</var><span style="color:blue;">)</span>	</td><td><a href="mml_sweep.html">音源固有のパラメータ(sコマンド)</a>を指定します。	</td></tr>
<tr><td>@NS<var>n</var><span style="color:blue;">(</span>,<var>n</var><span style="color:blue;">)</span>	</td><td><a href="mml_N163set.html">N16xの音色・サンプル長</a>を指定します。	</td></tr>
<tr><td>@<var>n</var>	</td><td><a href="mml_voice.html">音色</a>を指定します。<a href="mml_envelop.html">音色エンベロープ</a>と同時に設定することはできません。	</td></tr>
<tr><td>E@<var>n</var>	</td><td><a href="mml_envelop.html">音色エンベロープ</a>を指定します。<a href="mml_voice.html">音色</a>と同時に設定することはできません。	</td></tr>
<tr><td>Ev<var>n</var>	</td><td><a href="mml_envelop.html">音量エンベロープ</a>を指定します。	</td></tr>
<tr><td>Em<var>n</var>	</td><td><a href="mml_envelop.html">音程エンベロープ</a>を指定します。	</td></tr>
<tr><td>En<var>n</var>	</td><td><a href="mml_envelop.html">ノートエンベロープ</a>を指定します。	</td></tr>
<tr><td>S<var>n</var><span style="color:blue;">(</span>,<var>f</var><span style="color:blue;">)</span>	</td><td>呼び出す<a href="mml_sub.html">サブルーチン</a>を指定します。<br>
									<var>n</var> : サブルーチン番号<br><var>f</var> : 最適化無効フラグ（"1"で必ずサブルーチンを埋め込みます。）	</td></tr>
</table>

</div>

<!-- ──────────────── -->
<div class='block'>
<h3>内容（Contents）</h3>

<p>
指定の音域毎に、音色やエンベロープを指定します。<br>
この機能により、生楽器のような、音域毎の倍音成分の違いや、エンベロープの違いを表現可能です。<br>
</p>
<p>
また、ノイズトラック(TR4)をドラムセット化し、シーケンス記述の簡素化が可能です。<br>
</p>

</div>

<!-- ──────────────── -->
<div class='block'>
<h3>注意（Notes）</h3>
<p>
パッチ定義に記述された<a href="mml_sub.html">サブルーチン</a>については、
呼び出した<a href="mml_sub.html">サブルーチン</a>番号を記憶しておき、呼び出すべき<a href="mml_sub.html">サブルーチン</a>の番号が変化したときにだけ、<a href="mml_sub.html">サブルーチン</a>呼び出しを行います。<br>
シーケンス肥大化防止のため、常に<a href="mml_sub.html">サブルーチン</a>の挿入は行わない旨、留意してください。<br>
</p>
<p>
パッチ定義に<a href="mml_transpose.html">_コマンド</a>を定義した場合は、シーケンスに<a href="mml_transpose.html">_コマンド</a>を挿入するため、
それまでの<a href="mml_transpose.html">_コマンド, __コマンド</a>による移調の値を上書きする旨、注意してください。<br>
</p>
<p>
音域の判定は、<a href="mml_transpose.html">_コマンド</a>による移調を計算に含めません。<br>
尚、<a href="mml_keyshift.html">kコマンド</a>による移調は、計算に含めます。<br>
</p>
</div>

<!-- ──────────────── -->
<div class='block'>
<h3>例（Sample）</h3>

<code><pre>
#Code   "nsd_n163.bin"
<span style="color:green;">
//======================================================================
//	Wave table for Piano
//======================================================================
</span>
<span style="color:green;">//Sampling = o2a</span>
N163(2){
     8,11,14,12, 9, 9,10,10,14,15,13,10, 9,11, 7, 4,
     2, 3, 1, 0, 3, 6, 5, 8,10, 7, 4, 2, 3, 6, 7, 5
}

<span style="color:green;">//Sampling = o3a</span>
N163(3){
     9,10,10, 9,10,12,14,15,14,12,11, 9,10,10, 9, 8,
     6, 4, 2, 1, 0, 1, 3, 5, 6, 5, 4, 3, 5, 7, 8, 7
}

<span style="color:green;">//Sampling = o4a</span>
N163(4){
     8, 9,10,11,11,11,12,13,14,15,15,15,14,12,10, 8,
     6, 4, 3, 2, 1, 0, 0, 1, 2, 4, 5, 6, 6, 7, 7, 8
}

<span style="color:green;">//Sampling = o5a</span>
N163(15){
     8,10,11,13,15,14,13,14,13,11, 9, 6, 2, 0, 1, 4,
}

<span style="color:green;">//Sampling = o6a</span>
N163(16){
     8,11,13,14,15,14,15,13,11, 8, 5, 3, 1, 0, 2, 4,
}

<span style="color:green;">
//======================================================================
//	Envelope	for Piano
//======================================================================
</span>
E( 0){ (15,12,6),(12,6,255) L 6 R (6,0, 72) L 0 } <span style="color:green;">// o1c -</span>
E( 1){ (15,12,6),(12,5,225) L 5 R (5,0, 64) L 0 } <span style="color:green;">// o1a -</span>
E( 2){ (15,12,5),(12,5,196) L 5 R (5,0, 56) L 0 } <span style="color:green;">// o2e -</span>
E( 3){ (15,12,5),(12,5,169) L 5 R (5,0, 49) L 0 } <span style="color:green;">// o2a -</span>
E( 4){ (15,12,5),(12,4,144) L 4 R (4,0, 42) L 0 } <span style="color:green;">// o3e -</span>
E( 5){ (15,12,4),(12,4,121) L 4 R (4,0, 36) L 0 } <span style="color:green;">// o3a -</span>
E( 6){ (15,12,4),(12,4,100) L 4 R (4,0, 30) L 0 } <span style="color:green;">// o4e -</span>
E( 7){ (15,12,4),(12,3, 81) L 3 R (3,0, 25) L 0 } <span style="color:green;">// o4a -</span>
E( 8){ (15,12,3),(12,3, 64) L 3 R (3,0, 20) L 0 } <span style="color:green;">// o5e -</span>
E( 9){ (15,12,3),(12,3, 49) L 3 R (3,0, 16) L 0 } <span style="color:green;">// o5a -</span>
E(10){ (15,12,3),(12,2, 36) L 2 R (2,0, 12) L 0 } <span style="color:green;">// o6e -</span>
E(11){ (15,12,2),(12,2, 25) L 2 R (2,0,  9) L 0 } <span style="color:green;">// o6a -</span>
E(12){ (15,12,2),(12,2, 16) L 2 R (2,0,  6) L 0 } <span style="color:green;">// o7e -</span>
E(13){ (15,12,1),(12,1,  9) L 1 R (1,0,  4) L 0 } <span style="color:green;">// o7a -</span>
E(14){ (15,12,1),(12,1,  4) L 1 R (1,0,  2) L 0 } <span style="color:green;">// o8e -</span>
E(15){ (15,12,1),(12,1,  1) L 1 R (1,0,  1) L 0 } <span style="color:green;">// o8a -</span>

<span style="color:green;">
//======================================================================
//  Patch
//======================================================================
</span>
Patch(10){

        @NS  0,32   _+36    Ev0	    <span style="color:green;">//Range = c1 - g#1</span>
    a1  @NS  0,32   _+36    Ev1	    <span style="color:green;">//Range = a1 - d#2</span>
    e2  @NS  0,32   _+36    Ev2	    <span style="color:green;">//Range = e2 - g#2</span>
    a2  @NS  0,32   _+36    Ev3	    <span style="color:green;">//Range = a2 - d#3</span>

    e3  @NS 32,32   _+36    Ev4	    <span style="color:green;">//Range = e3 - g#3</span>
    a3  @NS 32,32   _+36    Ev5	    <span style="color:green;">//Range = a3 - d#4</span>
    e4  @NS 64,32   _+36    Ev6	    <span style="color:green;">//Range = e4 - g#4</span>
    a4  @NS 64,32   _+36    Ev7	    <span style="color:green;">//Range = a4 - d#5</span>

    e5  @NS 96,16   _+24    Ev8	    <span style="color:green;">//Range = e5 - g#5</span>
    a5  @NS 96,16   _+24    Ev9	    <span style="color:green;">//Range = a5 - d#6</span>
    e6  @NS112,16   _+24    Ev10    <span style="color:green;">//Range = e6 - g#6</span>
    a6  @NS112,16   _+24    Ev11    <span style="color:green;">//Range = a6 - d#7</span>

    e7  @NS112,16   _+24    Ev12    <span style="color:green;">//Range = e7 - g#7</span>
    a7  @NS112,16   _+24    Ev13    <span style="color:green;">//Range = a7 - d#8</span>
    e8  @NS112,16   _+24    Ev14    <span style="color:green;">//Range = e8 - g#8</span>
    a8  @NS112,16   _+24    Ev15    <span style="color:green;">//Range = a8 - d#9</span>
}
<span style="color:green;">
//======================================================================
//  Sequence
//======================================================================
</span>
bgm(0)
{
    t96

    NC8	@NL  0, 2
        @NL 32, 3
        @NL 64, 4
        @NL 96,15
        @NL112,16       <span style="color:green;">//n16x への転送はここで済ます。</span>

    TR6,7,8,9,10,11,12,13	@P10

    TR6     l4  o4  cdefgab>c1

}

</pre></code>

</div>

</div>

</BODY>
</HTML>
